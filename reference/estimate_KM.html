<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Wrapper for Kaplan Meier Time-to-Event analysis — estimate_KM • visR</title>

<!-- favicons -->
<link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png" />
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png" />
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png" />
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png" />

<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous" />

<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script>

<!-- bootstrap-toc -->
<link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>




<meta property="og:title" content="Wrapper for Kaplan Meier Time-to-Event analysis — estimate_KM" />
<meta property="og:description" content="This function is a wrapper around survival::survfit.formula to perform a Kaplan-Meier analysis, assuming right-censored data.
The function expects that the data has been filtered on the parameter (PARAM/PARAMCD) of interest.
Alternatively, PARAM/PARAMCD can be used in the strata argument. 
The result is an object of class survfit which can be used in downstream functions and methods that rely on the survfit class.
By default:
The Kaplan Meier estimate is estimated directly (stype = 1).
The cumulative hazard is estimated using the Nelson-Aalen estimator (ctype = 1): H.tilde = cumsum(x$n.event/x$n.risk).
The MLE (H.hat(t) = -log(S.hat(t))) can't be requested.
A two-sided pointwise 0.95 confidence interval is estimated using a log transformation (conf.type = &quot;log&quot;).

" />
<meta property="og:image" content="https://openpharma.github.io/visR/logo.png" />




<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->



  </head>

  <body data-spy="scroll" data-target="#toc">
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">visR</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.1.1.9004</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="../articles/Time_to_event_analysis.html">Survival Analysis with visR</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/openpharma/visR/">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Wrapper for Kaplan Meier Time-to-Event analysis</h1>
    <small class="dont-index">Source: <a href='https://github.com/openpharma/visR/blob/master/R/estimate_KM.R'><code>R/estimate_KM.R</code></a></small>
    <div class="hidden name"><code>estimate_KM.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>This function is a wrapper around <code><a href='https://rdrr.io/pkg/survival/man/survfit.formula.html'>survival::survfit.formula</a></code> to perform a Kaplan-Meier analysis, assuming right-censored data.
The function expects that the data has been filtered on the parameter (PARAM/PARAMCD) of interest.
Alternatively, PARAM/PARAMCD can be used in the <code>strata</code> argument. <br />
The result is an object of class <code>survfit</code> which can be used in downstream functions and methods that rely on the <code>survfit</code> class.
By default:</p><ul>
<li><p>The Kaplan Meier estimate is estimated directly (stype = 1).</p></li>
<li><p>The cumulative hazard is estimated using the Nelson-Aalen estimator (ctype = 1): H.tilde = cumsum(x$n.event/x$n.risk).
The MLE (H.hat(t) = -log(S.hat(t))) can't be requested.</p></li>
<li><p>A two-sided pointwise 0.95 confidence interval is estimated using a log transformation (conf.type = "log").</p></li>
</ul>

    </div>

    <pre class="usage"><span class='fu'>estimate_KM</span><span class='op'>(</span>data <span class='op'>=</span> <span class='cn'>NULL</span>, strata <span class='op'>=</span> <span class='cn'>NULL</span>, CNSR <span class='op'>=</span> <span class='st'>"CNSR"</span>, AVAL <span class='op'>=</span> <span class='st'>"AVAL"</span>, <span class='va'>...</span><span class='op'>)</span></pre>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>data</th>
      <td><p>The name of the dataset for Time-to-Event analysis based on the Analysis Data Model (ADaM) principles. The dataset is expected to have
one record per subject per analysis parameter. Rows in which the analysis variable (AVAL) or the sensor variable (CNSR) contain NA, are removed during analysis.</p></td>
    </tr>
    <tr>
      <th>strata</th>
      <td><p>Character vector, representing the strata for Time-to-Event analysis. When NULL, an overall analysis is performed.
Default is NULL.</p></td>
    </tr>
    <tr>
      <th>CNSR</th>
      <td><p>Censor for Time-to-Event analysis. Default is "CNSR", as per CDISC ADaM guiding principles.</p></td>
    </tr>
    <tr>
      <th>AVAL</th>
      <td><p>Analysis value for Time-to-Event analysis. Default is "AVAL", as per CDISC ADaM guiding principles.</p></td>
    </tr>
    <tr>
      <th>...</th>
      <td><p>additional arguments passed on to the ellipsis of the call <code>survival::survfit.formula(data = data, formula = Surv(AVAL, 1-CNSR) ~ strata), ...)</code> .
Use <code><a href='https://rdrr.io/pkg/survival/man/survfit.formula.html'>?survival::survfit.formula</a></code> and <code><a href='https://rdrr.io/pkg/survival/man/survival-internal.html'>?survival::survfitCI</a></code> for more information.</p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>survfit object, extended by elements PARAM/PARAMCD, ready for downstream processing in estimation or visualization functions and methods.</p>
    <h2 class="hasAnchor" id="references"><a class="anchor" href="#references"></a>References</h2>

    <p><a href='https://https://github.com/therneau/survival'>https://https://github.com/therneau/survival</a></p>
    <h2 class="hasAnchor" id="see-also"><a class="anchor" href="#see-also"></a>See also</h2>

    <div class='dont-index'><p><code><a href='https://rdrr.io/pkg/survival/man/survfit.formula.html'>survfit.formula</a> <a href='https://rdrr.io/pkg/survival/man/survival-internal.html'>survfitCI</a></code></p></div>
    <h2 class="hasAnchor" id="author"><a class="anchor" href="#author"></a>Author</h2>

    <p>Steven Haesendonckx</p>

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'><span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'><a href='https://github.com/openpharma/visR'>visR</a></span><span class='op'>)</span>

<span class='co'>## No stratification</span>
<span class='fu'>visR</span><span class='fu'>::</span><span class='fu'>estimate_KM</span><span class='op'>(</span>data <span class='op'>=</span> <span class='va'>adtte</span><span class='op'>)</span>
</div><div class='output co'>#&gt; Call: survfit(formula = survival::Surv(AVAL, 1 - CNSR) ~ 1, data = adtte)
#&gt; 
#&gt;       n  events  median 0.95LCL 0.95UCL 
#&gt;     254     152      51      44      70 </div><div class='input'>
<span class='co'>## Stratified Kaplan-Meier analysis by `TRTP`</span>
<span class='fu'>visR</span><span class='fu'>::</span><span class='fu'>estimate_KM</span><span class='op'>(</span>data <span class='op'>=</span> <span class='va'>adtte</span>, strata <span class='op'>=</span> <span class='st'>"TRTP"</span><span class='op'>)</span>
</div><div class='output co'>#&gt; Call: survfit(formula = survival::Surv(AVAL, 1 - CNSR) ~ TRTP, data = adtte)
#&gt; 
#&gt;                            n events median 0.95LCL 0.95UCL
#&gt; TRTP=Placebo              86     29     NA      NA      NA
#&gt; TRTP=Xanomeline High Dose 84     61     36      25      47
#&gt; TRTP=Xanomeline Low Dose  84     62     33      28      51</div><div class='input'>
<span class='co'>## Stratified Kaplan-Meier analysis by `TRTP` and `SEX`</span>
<span class='fu'>visR</span><span class='fu'>::</span><span class='fu'>estimate_KM</span><span class='op'>(</span>data <span class='op'>=</span> <span class='va'>adtte</span>, strata <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"TRTP"</span>, <span class='st'>"SEX"</span><span class='op'>)</span><span class='op'>)</span>
</div><div class='output co'>#&gt; Call: survfit(formula = survival::Surv(AVAL, 1 - CNSR) ~ TRTP + SEX, 
#&gt;     data = adtte)
#&gt; 
#&gt;                                   n events median 0.95LCL 0.95UCL
#&gt; TRTP=Placebo, SEX=F              53     19     NA      90      NA
#&gt; TRTP=Placebo, SEX=M              33     10     NA      NA      NA
#&gt; TRTP=Xanomeline High Dose, SEX=F 40     27     46      30      70
#&gt; TRTP=Xanomeline High Dose, SEX=M 44     34     25      20      46
#&gt; TRTP=Xanomeline Low Dose, SEX=F  50     34     43      29     100
#&gt; TRTP=Xanomeline Low Dose, SEX=M  34     28     27      21      51</div><div class='input'>
<span class='co'>## Stratification with one level</span>
<span class='fu'>visR</span><span class='fu'>::</span><span class='fu'>estimate_KM</span><span class='op'>(</span>data <span class='op'>=</span> <span class='va'>adtte</span>, strata <span class='op'>=</span> <span class='st'>"PARAMCD"</span><span class='op'>)</span>
</div><div class='output co'>#&gt; Call: survfit(formula = survival::Surv(AVAL, 1 - CNSR) ~ PARAMCD, data = adtte)
#&gt; 
#&gt;       n  events  median 0.95LCL 0.95UCL 
#&gt;     254     152      51      44      70 </div><div class='input'>
<span class='co'>## Analysis on subset of adtte</span>
<span class='fu'>visR</span><span class='fu'>::</span><span class='fu'>estimate_KM</span><span class='op'>(</span>data <span class='op'>=</span> <span class='va'>adtte</span><span class='op'>[</span><span class='va'>adtte</span><span class='op'>$</span><span class='va'>SEX</span> <span class='op'>==</span> <span class='st'>"F"</span>, <span class='op'>]</span><span class='op'>)</span>
</div><div class='output co'>#&gt; Call: survfit(formula = survival::Surv(AVAL, 1 - CNSR) ~ 1, data = adtte[adtte$SEX == 
#&gt;     "F", ])
#&gt; 
#&gt;       n  events  median 0.95LCL 0.95UCL 
#&gt;     143      80      64      47      96 </div><div class='input'>
<span class='co'>## Modify the default analysis by using the ellipsis</span>
<span class='fu'>estimate_KM</span><span class='op'>(</span>data <span class='op'>=</span> <span class='va'>adtte</span>, strata <span class='op'>=</span> <span class='cn'>NULL</span>, type <span class='op'>=</span> <span class='st'>"kaplan-meier"</span>, conf.int <span class='op'>=</span> <span class='cn'>F</span>, timefix <span class='op'>=</span> <span class='cn'>TRUE</span><span class='op'>)</span>
</div><div class='output co'>#&gt; Call: survfit(formula = survival::Surv(AVAL, 1 - CNSR) ~ 1, data = adtte, 
#&gt;     timefix = TRUE, type = "kaplan-meier", conf.int = FALSE)
#&gt; 
#&gt;      n events median 
#&gt;    254    152     51 </div><div class='input'><span class='fu'>estimate_KM</span><span class='op'>(</span>data <span class='op'>=</span> <span class='va'>adtte</span>, strata <span class='op'>=</span> <span class='cn'>NULL</span>, type <span class='op'>=</span> <span class='st'>"kaplan-meier"</span>, conf.int <span class='op'>=</span> <span class='cn'>FALSE</span>, timefix <span class='op'>=</span> <span class='cn'>TRUE</span><span class='op'>)</span>
</div><div class='output co'>#&gt; Call: survfit(formula = survival::Surv(AVAL, 1 - CNSR) ~ 1, data = adtte, 
#&gt;     timefix = TRUE, type = "kaplan-meier", conf.int = FALSE)
#&gt; 
#&gt;      n events median 
#&gt;    254    152     51 </div><div class='input'>
<span class='co'>## Example working with non CDISC data</span>
<span class='fu'><a href='https://rdrr.io/r/utils/head.html'>head</a></span><span class='op'>(</span><span class='va'>veteran</span><span class='op'>)</span>
</div><div class='output co'>#&gt;   trt celltype time status karno diagtime age prior
#&gt; 1   1 squamous   72      1    60        7  69     0
#&gt; 2   1 squamous  411      1    70        5  64    10
#&gt; 3   1 squamous  228      1    60        3  38     0
#&gt; 4   1 squamous  126      1    60        9  63    10
#&gt; 5   1 squamous  118      1    70       11  65    10
#&gt; 6   1 squamous   10      1    20        5  49     0</div><div class='input'>
<span class='co'># convert time and censoring data to ADaM variables </span>
<span class='va'>veteran_adam</span> <span class='op'>&lt;-</span> <span class='va'>veteran</span> <span class='op'>%&gt;%</span>
 <span class='fu'><a href='https://dplyr.tidyverse.org/reference/mutate.html'>mutate</a></span><span class='op'>(</span>
  AVAL <span class='op'>=</span> <span class='va'>time</span>, 
  CNSR <span class='op'>=</span> <span class='fu'><a href='https://dplyr.tidyverse.org/reference/if_else.html'>if_else</a></span><span class='op'>(</span><span class='va'>status</span> <span class='op'>==</span> <span class='fl'>1</span>, <span class='fl'>0</span>, <span class='fl'>1</span><span class='op'>)</span> <span class='co'>#convert censoring status to CDISC principles</span>
  <span class='op'>)</span>

<span class='fu'>estimate_KM</span><span class='op'>(</span>data <span class='op'>=</span> <span class='va'>veteran_adam</span>, strata <span class='op'>=</span> <span class='st'>"trt"</span><span class='op'>)</span>
</div><div class='output co'>#&gt; Call: survfit(formula = survival::Surv(AVAL, 1 - CNSR) ~ trt, data = veteran_adam)
#&gt; 
#&gt;        n events median 0.95LCL 0.95UCL
#&gt; trt=1 69     64  103.0      59     132
#&gt; trt=2 68     64   52.5      44      95</div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top">
      <h2 data-toc-skip>Contents</h2>
    </nav>
  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by Diego Saldana, Charlotta Fruechtenicht, Mark Baillie, Marc Vandemeulebroecke, Thanos Siadimas, Pawel Kawski, Steven Haesendonckx, Pelagia Alexandra Papadopoulou, Tim Treis, Rebecca Albrecht.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
   </div>

  


  </body>
</html>


